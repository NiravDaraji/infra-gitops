suite: Deployment basics
templates:
  - templates/deployment.yaml

tests:

  - it: should render a Deployment resource
    asserts:
      - isKind:
          of: Deployment

  - it: should set replica count from values.yaml
    asserts:
      - equal:
          path: spec.replicas
          value: 1

  - it: should set container image correctly
    asserts:
      - equal:
          path: spec.template.spec.containers[0].image
          value: "openspeedtest/latest:v2.0.0"

  - it: should set imagePullPolicy to Always
    asserts:
      - equal:
          path: spec.template.spec.containers[0].imagePullPolicy
          value: "Always"

  - it: should expose HTTP port 3000
    asserts:
      - equal:
          path: spec.template.spec.containers[0].ports[0].name
          value: "http"
      - equal:
          path: spec.template.spec.containers[0].ports[0].containerPort
          value: 3000

